<head>
  <style> body { margin: 0; } </style>

  <script src="//unpkg.com/force-graph"></script>
  <!--<script src="../../dist/force-graph.js"></script>-->
</head>

<body>
  <div id="graph"></div>
  <script>
     // gen a number persistent color from around the palette
    const getColor = n => '#' + ((n * 124680) % Math.pow(2, 24)).toString(16).padStart(6, '0');

    const gData = 
{"nodes": [{"id": "青花菜 $46.71", "group": 46.71},{"id": "花椰菜 $62.02", "group": 62.02},{"id": "胡瓜 $21.37", "group": 21.37},{"id": "絲瓜 $29.41", "group": 29.41},{"id": "扁蒲 $21.74", "group": 21.74},{"id": "茄子 $26.53", "group": 26.53},{"id": "番茄 $42.02", "group": 42.02},{"id": "甜椒 $74.21", "group": 74.21},{"id": "豌豆 $64.81", "group": 64.81},{"id": "毛豆 $48.19", "group": 48.19},{"id": "南瓜 $19.26", "group": 19.26},{"id": "辣椒 $48.62", "group": 48.62},{"id": "菜豆 $53.51", "group": 53.51},{"id": "金針花 $201.15", "group": 201.15}],"links": [{"source": "青花菜 $46.71", "target": "菜豆 $53.51", "value":53.51},{"source": "花椰菜 $62.02", "target": "胡瓜 $21.37", "value":21.37},{"source": "花椰菜 $62.02", "target": "青花菜 $46.71", "value":46.71},{"source": "胡瓜 $21.37", "target": "豌豆 $64.81", "value":64.81},{"source": "胡瓜 $21.37", "target": "青花菜 $46.71", "value":46.71},{"source": "胡瓜 $21.37", "target": "菜豆 $53.51", "value":53.51},{"source": "胡瓜 $21.37", "target": "花椰菜 $62.02", "value":62.02},{"source": "絲瓜 $29.41", "target": "茄子 $26.53", "value":26.53},{"source": "扁蒲 $21.74", "target": "毛豆 $48.19", "value":48.19},{"source": "扁蒲 $21.74", "target": "菜豆 $53.51", "value":53.51},{"source": "扁蒲 $21.74", "target": "青花菜 $46.71", "value":46.71},{"source": "扁蒲 $21.74", "target": "金針花 $201.15", "value":201.15},{"source": "扁蒲 $21.74", "target": "豌豆 $64.81", "value":64.81},{"source": "扁蒲 $21.74", "target": "南瓜 $19.26", "value":19.26},{"source": "扁蒲 $21.74", "target": "花椰菜 $62.02", "value":62.02},{"source": "扁蒲 $21.74", "target": "胡瓜 $21.37", "value":21.37},{"source": "扁蒲 $21.74", "target": "茄子 $26.53", "value":26.53},{"source": "扁蒲 $21.74", "target": "絲瓜 $29.41", "value":29.41},{"source": "茄子 $26.53", "target": "絲瓜 $29.41", "value":29.41},{"source": "茄子 $26.53", "target": "金針花 $201.15", "value":201.15},{"source": "番茄 $42.02", "target": "毛豆 $48.19", "value":48.19},{"source": "番茄 $42.02", "target": "菜豆 $53.51", "value":53.51},{"source": "番茄 $42.02", "target": "青花菜 $46.71", "value":46.71},{"source": "番茄 $42.02", "target": "金針花 $201.15", "value":201.15},{"source": "番茄 $42.02", "target": "豌豆 $64.81", "value":64.81},{"source": "番茄 $42.02", "target": "南瓜 $19.26", "value":19.26},{"source": "番茄 $42.02", "target": "花椰菜 $62.02", "value":62.02},{"source": "番茄 $42.02", "target": "胡瓜 $21.37", "value":21.37},{"source": "番茄 $42.02", "target": "茄子 $26.53", "value":26.53},{"source": "番茄 $42.02", "target": "絲瓜 $29.41", "value":29.41},{"source": "甜椒 $74.21", "target": "毛豆 $48.19", "value":48.19},{"source": "甜椒 $74.21", "target": "菜豆 $53.51", "value":53.51},{"source": "甜椒 $74.21", "target": "青花菜 $46.71", "value":46.71},{"source": "甜椒 $74.21", "target": "金針花 $201.15", "value":201.15},{"source": "甜椒 $74.21", "target": "豌豆 $64.81", "value":64.81},{"source": "甜椒 $74.21", "target": "南瓜 $19.26", "value":19.26},{"source": "甜椒 $74.21", "target": "花椰菜 $62.02", "value":62.02},{"source": "甜椒 $74.21", "target": "胡瓜 $21.37", "value":21.37},{"source": "甜椒 $74.21", "target": "茄子 $26.53", "value":26.53},{"source": "甜椒 $74.21", "target": "絲瓜 $29.41", "value":29.41},{"source": "豌豆 $64.81", "target": "青花菜 $46.71", "value":46.71},{"source": "豌豆 $64.81", "target": "菜豆 $53.51", "value":53.51},{"source": "毛豆 $48.19", "target": "茄子 $26.53", "value":26.53},{"source": "毛豆 $48.19", "target": "絲瓜 $29.41", "value":29.41},{"source": "毛豆 $48.19", "target": "金針花 $201.15", "value":201.15},{"source": "南瓜 $19.26", "target": "青花菜 $46.71", "value":46.71},{"source": "南瓜 $19.26", "target": "菜豆 $53.51", "value":53.51},{"source": "辣椒 $48.62", "target": "毛豆 $48.19", "value":48.19},{"source": "辣椒 $48.62", "target": "菜豆 $53.51", "value":53.51},{"source": "辣椒 $48.62", "target": "青花菜 $46.71", "value":46.71},{"source": "辣椒 $48.62", "target": "金針花 $201.15", "value":201.15},{"source": "辣椒 $48.62", "target": "豌豆 $64.81", "value":64.81},{"source": "辣椒 $48.62", "target": "南瓜 $19.26", "value":19.26},{"source": "辣椒 $48.62", "target": "花椰菜 $62.02", "value":62.02},{"source": "辣椒 $48.62", "target": "胡瓜 $21.37", "value":21.37},{"source": "辣椒 $48.62", "target": "茄子 $26.53", "value":26.53},{"source": "辣椒 $48.62", "target": "絲瓜 $29.41", "value":29.41},{"source": "菜豆 $53.51", "target": "毛豆 $48.19", "value":48.19},{"source": "菜豆 $53.51", "target": "菜豆 $53.51", "value":53.51},{"source": "菜豆 $53.51", "target": "青花菜 $46.71", "value":46.71},{"source": "菜豆 $53.51", "target": "金針花 $201.15", "value":201.15},{"source": "菜豆 $53.51", "target": "豌豆 $64.81", "value":64.81},{"source": "菜豆 $53.51", "target": "南瓜 $19.26", "value":19.26},{"source": "菜豆 $53.51", "target": "花椰菜 $62.02", "value":62.02},{"source": "菜豆 $53.51", "target": "胡瓜 $21.37", "value":21.37},{"source": "菜豆 $53.51", "target": "茄子 $26.53", "value":26.53},{"source": "菜豆 $53.51", "target": "絲瓜 $29.41", "value":29.41},{"source": "金針花 $201.15", "target": "毛豆 $48.19", "value":48.19},{"source": "金針花 $201.15", "target": "菜豆 $53.51", "value":53.51},{"source": "金針花 $201.15", "target": "青花菜 $46.71", "value":46.71},{"source": "金針花 $201.15", "target": "金針花 $201.15", "value":201.15},{"source": "金針花 $201.15", "target": "豌豆 $64.81", "value":64.81},{"source": "金針花 $201.15", "target": "南瓜 $19.26", "value":19.26},{"source": "金針花 $201.15", "target": "花椰菜 $62.02", "value":62.02},{"source": "金針花 $201.15", "target": "胡瓜 $21.37", "value":21.37},{"source": "金針花 $201.15", "target": "茄子 $26.53", "value":26.53},{"source": "金針花 $201.15", "target": "絲瓜 $29.41", "value":29.41}]} 
      ;
    
     //.cooldownTicks(100)
      const Graph = ForceGraph()
      (document.getElementById('graph'))
        .graphData(gData)
        .nodeId('id')
        .nodeVal('value')
        //.nodeAutoColorBy('group')
       
        .linkSource('source')
        .linkTarget('target')
        .linkAutoColorBy('source')
        
        .cooldownTicks(1)
        
        .nodeCanvasObject((node, ctx, globalScale) => {
          const label = node.id ; //
          const fontSize = 12/globalScale;
          ctx.font = `${fontSize}px Sans-Serif`;
          const textWidth = ctx.measureText(label).width;
          const bckgDimensions = [textWidth, fontSize].map(n => n + fontSize * 0.2); // some padding
          ctx.nodeVal = 50;
          ctx.fillStyle = getColor(Math.floor(Math.random() * 1000));  //'rgba(255, 255, 255, 0.8)' node.id  Math.floor(Math.random() * 1000)
          //ctx.fillRect(node.x - bckgDimensions[0] / 2, node.y - bckgDimensions[1] / 2, ...bckgDimensions);

          ctx.beginPath(); 
          ctx.arc(node.x, node.y,parseFloat(Math.sqrt(node.group)), 0, 2 * Math.PI, false); 
          ctx.fill();
          
          ctx.textAlign = 'center';
          ctx.textBaseline = 'middle';
          ctx.fillStyle = 'rgba(255, 255, 255, 1)';  //'rgba(0, 0, 0, 0)'
          ctx.fillText(label, node.x, node.y);

          node.__bckgDimensions = bckgDimensions; // to re-use in nodePointerAreaPaint
        })
        .nodePointerAreaPaint((node, color, ctx) => {
          ctx.fillStyle = color;
          const bckgDimensions = node.__bckgDimensions;
          bckgDimensions && ctx.fillRect(node.x - bckgDimensions[0] / 2, node.y - bckgDimensions[1] / 2, ...bckgDimensions);

          
    });
    // fit to canvas when engine stops
    Graph.onEngineStop(() => Graph.zoomToFit(10));
  </script>
</body>
